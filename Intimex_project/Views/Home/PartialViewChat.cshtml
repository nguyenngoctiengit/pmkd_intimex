
@{
    ViewData["Title"] = "chat";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<!--EmojiOneArea -->
<link href="~/css/emojiPicker/jquery.emojipicker.css" rel="stylesheet" />
<script src="~/js/emojiPicker/jquery.emojipicker.js"></script>
<!-- Emoji Data -->
<link href="~/css/emojiPicker/jquery.emojipicker.tw.css" rel="stylesheet" />
<script src="~/js/emojiPicker/jquery.emojis.js"></script>
<!--css chat -->
<link href="~/css/Chat/PartialViewChat.css" rel="stylesheet" />
@*<link href="~/css/chat1.css" rel="stylesheet" />*@
<script src="~/js/notify.min.js"></script>

<style>

</style>
<script>
    $(function () {
        $("#messageInput1").emojiPicker({
            position: 'top'

        });
        document.getElementById('messageInput1').style.width = '100%';
    });
</script>

<div class="right_col" role="main" style="height: 100%">
    <div class="">

        <h3 class="text-center">Messing to @ViewBag.messingTo</h3>
        <div class="messaging">
            <div class="inbox_msg">
                <div class="inbox_people">
                    <div class="headind_srch">
                        <div class="srch_bar">
                            <div class="stylish-input-group">
                                <input type="text" class="search-bar" placeholder="Search" id="keySearch" onkeyup="Search()">
                            </div>
                        </div>
                    </div>
                    <div class="inbox_chat scroll">
                        @{ foreach (var item in ViewBag.user)
                            {
                                <button class="buttonChat" onclick="location.href='/home/PartialViewChat/@item.Id'" value="@item.NormalizedUserName" style="padding:0;border:none;background:none" type="submit">
                                    <div class="chat_list">
                                        <div class="chat_people">
                                            <div class="chat_img"> <img src="~/Images/@item.Image" /> </div>
                                            <div class="chat_ib">
                                                <h5>
                                                    @item.NormalizedUserName
                                                    @{
                                                        if (item.Online == true)
                                                        {
                                                            <span class="chat_date">Online</span>
                                                        }
                                                        else
                                                        {
                                                            <span class="chat_date">Offline</span>
                                                        }
                                                    }

                                                </h5>
                                            </div>
                                        </div>
                                    </div>
                                </button>
                            }
                        }

                    </div>
                </div>
                <input type="text" id="senderInput" value="@ViewBag.sender" hidden />
                <input type="text" id="receiverInput" value="@ViewBag.receiver" hidden />
                <div class="mesgs">
                    <div class="headind_srch">
                        <div class="srch_bar">
                            <div class="stylish-input-group">
                                <input type="text" class="search-bar" placeholder="Search" id="keySearchMessage" onkeyup="SearchMessage()">
                            </div>
                        </div>
                    </div>
                    <div class="msg_history" id="msg_history">
                        <script type="text/javascript">
                            function scrollChat() {
                                var msg_history = document.getElementById("msg_history");
                                msg_history.scrollTop = msg_history.scrollHeight;
                                document.getElementById('messageInput1').focus();

                            }
                            window.addEventListener('load', scrollChat);

                        </script>
                        <div class=""></div>
                        @{ foreach (var item in ViewBag.outMsg)
                            {
                                if (item.FromUser == ViewBag.sender && item.ToUser == ViewBag.receiver)
                                {
                                    <div class="outgoing_msg">
                                        <div class="sent_msg" id="sent_msg">
                                            <p onclick="DownloadDocument('@item.Message1')" style="cursor:pointer">
                                                @item.Message1
                                            </p>
                                            <span class="time_date"> @item.Date</span>
                                        </div>
                                    </div>
                                }
                                else
                                {
                                    <div class="incoming_msg">
                                        <div class="incoming_msg_img">
                                            <img src="~/Images/Avatar.PNG" />
                                        </div>
                                        <div class="received_msg">
                                            <div class="received_withd_msg">
                                                <p onclick="DownloadDocument('@item.Message1')" style="cursor:pointer">@item.Message1</p>
                                                <span class="time_date"> @item.Date</span>
                                            </div>
                                        </div>
                                    </div> }

                            } }
                        <div id="createDiv_incoming_msg"></div>
                        <div id="createDiv_outgoing_msg"></div>
                    </div>
                    <label class="custom-file-upload">
                        <input type="file" id="fileUpload" onchange="UploadFile(event)" hidden />
                        <i class="fa fa-cloud-upload"></i>
                    </label>
                    <div class="type_msg">
                        <div class="input_msg_write">
                            <input type="text" class="write_msg" id="messageInput1" placeholder="Type a message" style="width:100%" />
                            <button class="msg_send_btn" type="button" id="sendButton1"><i class="fa fa-paper-plane-o" aria-hidden="true"></i></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- signalr -->
<script src="~/lib/microsoft/signalr/dist/browser/signalr.js"></script>
<script src="~/js/chat.js"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
